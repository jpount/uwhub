<div class="tasks-container">

  <!-- Tasks Page Content -->
  <div class="tasks-content">
    <div class="page-header">
      <h1 class="page-title">Tasks</h1>
    </div>

    <!-- Task Tabs -->
    <div class="task-tabs">
      <div class="tab-nav">
        <button class="tab-btn personal-tab"
                [class.active]="viewMode() === 'personal'"
                (click)="setViewMode('personal')">
          <span class="tab-icon">ðŸ‘¤</span>
          Personal
        </button>
        <button class="tab-btn team-tab"
                [class.active]="viewMode() === 'team'"
                (click)="setViewMode('team')">
          <span class="tab-icon">ðŸ‘¥</span>
          Team view
        </button>
      </div>
    </div>

    <!-- Task Status Tabs -->
    <div class="status-tabs">
      <button 
        class="status-tab"
        [class.active]="activeTab() === 'open'"
        (click)="setActiveTab('open')">
        Open ({{ getTaskCounts().open }})
        <span class="notification-badge" *ngIf="getTaskCounts().open > 0">{{ getTaskCounts().open > 99 ? '99+' : getTaskCounts().open }}</span>
      </button>
      <button 
        class="status-tab"
        [class.active]="activeTab() === 'completed'"
        (click)="setActiveTab('completed')">
        Completed ({{ getTaskCounts().completed }})
      </button>
      <button 
        class="status-tab"
        [class.active]="activeTab() === 'all'"
        (click)="setActiveTab('all')">
        All ({{ getTaskCounts().all }})
      </button>
    </div>

    <!-- Last Updated Info -->
    <div class="last-updated">
      Last updated 31 Jul 25, 4:00pm
    </div>

    <!-- Tasks Table -->
    <div class="tasks-table-container">
      <table class="tasks-table" [class.team-view]="viewMode() === 'team'" *ngIf="getCurrentTasks().length > 0; else noTasks">
        <thead>
          <tr>
            <th class="flag-column">
              ðŸš©
            </th>
            <th class="sortable">
              Account Name â†• ðŸ”½
            </th>
            <th class="sortable">
              NAIC Description â†• ðŸ”½
            </th>
            <th class="sortable">
              LOB/Products â†• ðŸ”½
            </th>
            <th class="sortable">
              Transaction type â†• ðŸ”½
            </th>
            <th class="sortable">
              Propensity to bind â†• ðŸ”½
            </th>
            <th class="sortable">
              Status â†• ðŸ”½
            </th>
            <th class="sortable">
              Target action date â†• ðŸ”½
            </th>
            <th class="sortable">
              Pending action â†• ðŸ”½
            </th>
            <th class="sortable">
              Premium â†• ðŸ”½
            </th>
            <th class="sortable" *ngIf="viewMode() === 'team'">
              Assigned To â†• ðŸ”½
            </th>
            <th class="pin-column compact" style="width: 50px;">Pin</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let task of getCurrentTasks()" class="task-row">
            <td class="flag-column">
              <div class="priority-flag" *ngIf="task.priority">ðŸš©</div>
            </td>
            <td class="account-name">
              <a [routerLink]="['/task-detail', task.id]" class="task-link">
                {{ task.accountName }}<br>
                <small class="task-id">{{ task.id }}</small>
              </a>
            </td>
            <td class="naic-desc">{{ task.naicDescription }}</td>
            <td class="lob-products">{{ task.lobProducts }}</td>
            <td class="transaction-type">{{ task.transactionType }}</td>
            <td>
              <span class="propensity-badge" [ngClass]="getPropensityClass(task.propensityToBind)">
                {{ task.propensityToBind }}
              </span>
            </td>
            <td>
              <span class="status-badge" [ngClass]="getStatusClass(task.status)">
                {{ task.status }}
              </span>
            </td>
            <td class="target-date">{{ task.targetActionDate }}</td>
            <td class="pending-action">{{ task.pendingAction }}</td>
            <td class="premium">{{ formatPremium(task.premium) }}</td>
            <td class="assigned-to" *ngIf="viewMode() === 'team'">
              <span class="assignee-name" [class.current-user]="task.assignedTo === 'Jane Smith'">
                {{ task.assignedTo }}
              </span>
            </td>
            <td class="pin-column">
              <button class="pin-btn">ðŸ“Œ</button>
            </td>
          </tr>
        </tbody>
      </table>
      
      <ng-template #noTasks>
        <div class="no-tasks">
          <div class="no-tasks-icon">ðŸ“‹</div>
          <h3>No tasks found</h3>
          <p>There are no tasks matching the current filter.</p>
        </div>
      </ng-template>
    </div>
  </div>
</div>
